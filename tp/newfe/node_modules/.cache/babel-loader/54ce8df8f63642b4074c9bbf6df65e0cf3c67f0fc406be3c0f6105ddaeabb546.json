{"ast":null,"code":"// VisitService is a collection of functions that are used to commuicate with the Database.\nimport axios from\"axios\";// Gets and returns a user's visits from the database\nexport const getVisitsByUserId=async(user,getAccessTokenSilently)=>{try{const userId=user.sub.split(\"|\")[1];const token=await getAccessTokenSilently();const response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/visits/user/\").concat(userId),{headers:{Authorization:\"Bearer \".concat(token)}});return response.data;}catch(error){console.error(\"Error fetching visits: \",error);console.log(\"User: \",user.sub.split(\"|\")[1]);throw error;}};// Gets and returns the details of a visit from the database\nexport const getVisitDetails=async(visitId,getAccessTokenSilently)=>{// console.log(\"User: \", user);\ntry{const token=await getAccessTokenSilently();// console.log(\"User ID: \", userId);\nconst response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/visits/\").concat(visitId),{headers:{Authorization:\"Bearer \".concat(token)}});return response.data;}catch(error){console.error(\"Error fetching visit details: \",error);throw error;}};// Adds a visit to the database\nexport const addVisit=async(visit,getAccessTokenSilently)=>{try{const token=await getAccessTokenSilently();console.log(\"Visit: \",visit);const response=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/visits\"),visit,{headers:{Authorization:\"Bearer \".concat(token)}});console.log(\"Response: \",response);return response.data;}catch(error){console.error(\"Error adding visit: \",error);throw error;}};// Fetches and returns the parks from the database\nexport const fetchParks=async getAccessTokenSilently=>{try{const token=await getAccessTokenSilently();const response=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/parks\"),{headers:{Authorization:\"Bearer \".concat(token)}});return response.data;}catch(error){console.error(\"Error fetching parks: \",error);throw error;}};// Fetches and returns the attractions of a visit from the database\nexport const getVisitAttractions=async(visitId,getAccessTokenSilently)=>{try{const token=await getAccessTokenSilently();const visitResponse=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/visits/\").concat(visitId),{headers:{Authorization:\"Bearer \".concat(token)}});const mainParkId=visitResponse.data.park.id;const individualParksResponse=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/parks/\").concat(mainParkId),{headers:{Authorization:\"Bearer \".concat(token)}});const individualParks=individualParksResponse.data.parks;const attractionsPromises=individualParks.map(individualPark=>axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/parks/\").concat(individualPark.id,\"/attractions\"),{headers:{Authorization:\"Bearer \".concat(token)}}));const responses=await Promise.all(attractionsPromises);return responses.flatMap(res=>res.data);}catch(error){console.error(\"Error fetching attractions:\",error);throw error;}};// Deletes a visit from the database\nexport const deleteVisit=async(visitId,getAccessTokenSilently)=>{try{const token=await getAccessTokenSilently();await axios.delete(\"\".concat(process.env.REACT_APP_API_URL,\"/visits/\").concat(visitId),{headers:{Authorization:\"Bearer \".concat(token)}});}catch(error){console.error(\"Error fetching parks: \",error);throw error;}};","map":{"version":3,"names":["axios","getVisitsByUserId","user","getAccessTokenSilently","userId","sub","split","token","response","get","concat","process","env","REACT_APP_API_URL","headers","Authorization","data","error","console","log","getVisitDetails","visitId","addVisit","visit","post","fetchParks","getVisitAttractions","visitResponse","mainParkId","park","id","individualParksResponse","individualParks","parks","attractionsPromises","map","individualPark","responses","Promise","all","flatMap","res","deleteVisit","delete"],"sources":["C:/Users/Brian/Documents/GitHub/Theme-Park-LT/tp/newfe/src/services/API Calls/VisitService.js"],"sourcesContent":["// VisitService is a collection of functions that are used to commuicate with the Database.\r\n\r\nimport axios from \"axios\";\r\n\r\n\r\n\r\n// Gets and returns a user's visits from the database\r\nexport const getVisitsByUserId = async (user, getAccessTokenSilently) => {\r\n  try {\r\n    const userId = user.sub.split(\"|\")[1];\r\n    const token = await getAccessTokenSilently();\r\n    const response = await axios.get(\r\n      `${process.env.REACT_APP_API_URL}/visits/user/${userId}`,\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching visits: \", error);\r\n    console.log(\"User: \", user.sub.split(\"|\")[1]);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Gets and returns the details of a visit from the database\r\nexport const getVisitDetails = async (visitId, getAccessTokenSilently) => {\r\n  // console.log(\"User: \", user);\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    \r\n\r\n    // console.log(\"User ID: \", userId);\r\n    const response = await axios.get(\r\n      `${process.env.REACT_APP_API_URL}/visits/${visitId}`,  \r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching visit details: \", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Adds a visit to the database\r\nexport const addVisit = async (visit, getAccessTokenSilently) => {\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    console.log(\"Visit: \", visit);\r\n    const response = await axios.post(`${process.env.REACT_APP_API_URL}/visits`, visit, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    });\r\n    console.log(\"Response: \", response);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error adding visit: \", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Fetches and returns the parks from the database\r\nexport const fetchParks = async (getAccessTokenSilently) => {\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    const response = await axios.get(`${process.env.REACT_APP_API_URL}/parks`, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    });\r\n\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching parks: \", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Fetches and returns the attractions of a visit from the database\r\nexport const getVisitAttractions = async (visitId, getAccessTokenSilently) => {\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    const visitResponse = await axios.get(\r\n      `${process.env.REACT_APP_API_URL}/visits/${visitId}`,\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n    const mainParkId = visitResponse.data.park.id;\r\n    const individualParksResponse = await axios.get(\r\n      `${process.env.REACT_APP_API_URL}/parks/${mainParkId}`,\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n    const individualParks = individualParksResponse.data.parks;\r\n    const attractionsPromises = individualParks.map((individualPark) =>\r\n      axios.get(\r\n        `${process.env.REACT_APP_API_URL}/parks/${individualPark.id}/attractions`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      )\r\n    );\r\n\r\n    const responses = await Promise.all(attractionsPromises);\r\n    return responses.flatMap((res) => res.data);\r\n  } catch (error) {\r\n    console.error(\"Error fetching attractions:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Deletes a visit from the database\r\nexport const deleteVisit = async (visitId, getAccessTokenSilently) => {\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    await axios.delete(`${process.env.REACT_APP_API_URL}/visits/${visitId}`, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error fetching parks: \", error);\r\n    throw error;\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}