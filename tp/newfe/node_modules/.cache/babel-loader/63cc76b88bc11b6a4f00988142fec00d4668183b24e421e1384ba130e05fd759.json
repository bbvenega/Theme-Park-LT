{"ast":null,"code":"// VisitService is a collection of functions that are used to commuicate with the Database.\n\nimport axios from \"axios\";\n\n// Gets and returns a user's visits from the database\nexport const getVisitsByUserId = async (user, getAccessTokenSilently) => {\n  try {\n    const userId = user.sub.split(\"|\")[1];\n    const token = await getAccessTokenSilently();\n    const response = await axios.get(`${process.env.REACT_APP_API_URL}/visits/user/${userId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return response.data;\n  } catch (error) {\n    console.error(\"Error fetching visits: \", error);\n    console.log(\"User: \", user.sub.split(\"|\")[1]);\n    throw error;\n  }\n};\n\n// Gets and returns the details of a visit from the database\nexport const getVisitDetails = async (visitId, getAccessTokenSilently) => {\n  // console.log(\"User: \", user);\n  try {\n    const token = await getAccessTokenSilently();\n\n    // console.log(\"User ID: \", userId);\n    const response = await axios.get(`${process.env.REACT_APP_API_URL}/visits/${visitId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return response.data;\n  } catch (error) {\n    console.error(\"Error fetching visit details: \", error);\n    throw error;\n  }\n};\n\n// Adds a visit to the database\nexport const addVisit = async (visit, getAccessTokenSilently) => {\n  try {\n    const token = await getAccessTokenSilently();\n    console.log(\"Visit: \", visit);\n    const response = await axios.post(`${process.env.REACT_APP_API_URL}/visits`, visit, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    console.log(\"Response: \", response);\n    return response.data;\n  } catch (error) {\n    console.error(\"Error adding visit: \", error);\n    throw error;\n  }\n};\n\n// Fetches and returns the parks from the database\nexport const fetchParks = async getAccessTokenSilently => {\n  try {\n    const token = await getAccessTokenSilently();\n    const response = await axios.get(`${process.env.REACT_APP_API_URL}/parks`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return response.data;\n  } catch (error) {\n    console.error(\"Error fetching parks: \", error);\n    throw error;\n  }\n};\n\n// Fetches and returns the attractions of a visit from the database\nexport const getVisitAttractions = async (visitId, getAccessTokenSilently) => {\n  try {\n    const token = await getAccessTokenSilently();\n    const visitResponse = await axios.get(`${process.env.REACT_APP_API_URL}/visits/${visitId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    const mainParkId = visitResponse.data.park.id;\n    const individualParksResponse = await axios.get(`${process.env.REACT_APP_API_URL}/parks/${mainParkId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    const individualParks = individualParksResponse.data.parks;\n    const attractionsPromises = individualParks.map(individualPark => axios.get(`${process.env.REACT_APP_API_URL}/parks/${individualPark.id}/attractions`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }));\n    const responses = await Promise.all(attractionsPromises);\n    return responses.flatMap(res => res.data);\n  } catch (error) {\n    console.error(\"Error fetching attractions:\", error);\n    throw error;\n  }\n};\n\n// Deletes a visit from the database\nexport const deleteVisit = async (visitId, getAccessTokenSilently) => {\n  try {\n    const token = await getAccessTokenSilently();\n    await axios.delete(`${process.env.REACT_APP_API_URL}/visits/${visitId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n  } catch (error) {\n    console.error(\"Error fetching parks: \", error);\n    throw error;\n  }\n};","map":{"version":3,"names":["axios","getVisitsByUserId","user","getAccessTokenSilently","userId","sub","split","token","response","get","process","env","REACT_APP_API_URL","headers","Authorization","data","error","console","log","getVisitDetails","visitId","addVisit","visit","post","fetchParks","getVisitAttractions","visitResponse","mainParkId","park","id","individualParksResponse","individualParks","parks","attractionsPromises","map","individualPark","responses","Promise","all","flatMap","res","deleteVisit","delete"],"sources":["C:/Users/Brian/Documents/GitHub/Theme-Park-LT/tp/newfe/src/services/API Calls/VisitService.js"],"sourcesContent":["// VisitService is a collection of functions that are used to commuicate with the Database.\r\n\r\nimport axios from \"axios\";\r\n\r\n\r\n\r\n// Gets and returns a user's visits from the database\r\nexport const getVisitsByUserId = async (user, getAccessTokenSilently) => {\r\n  try {\r\n    const userId = user.sub.split(\"|\")[1];\r\n    const token = await getAccessTokenSilently();\r\n    const response = await axios.get(\r\n      `${process.env.REACT_APP_API_URL}/visits/user/${userId}`,\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching visits: \", error);\r\n    console.log(\"User: \", user.sub.split(\"|\")[1]);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Gets and returns the details of a visit from the database\r\nexport const getVisitDetails = async (visitId, getAccessTokenSilently) => {\r\n  // console.log(\"User: \", user);\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    \r\n\r\n    // console.log(\"User ID: \", userId);\r\n    const response = await axios.get(\r\n      `${process.env.REACT_APP_API_URL}/visits/${visitId}`,  \r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching visit details: \", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Adds a visit to the database\r\nexport const addVisit = async (visit, getAccessTokenSilently) => {\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    console.log(\"Visit: \", visit);\r\n    const response = await axios.post(`${process.env.REACT_APP_API_URL}/visits`, visit, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    });\r\n    console.log(\"Response: \", response);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error adding visit: \", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Fetches and returns the parks from the database\r\nexport const fetchParks = async (getAccessTokenSilently) => {\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    const response = await axios.get(`${process.env.REACT_APP_API_URL}/parks`, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    });\r\n\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching parks: \", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Fetches and returns the attractions of a visit from the database\r\nexport const getVisitAttractions = async (visitId, getAccessTokenSilently) => {\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    const visitResponse = await axios.get(\r\n      `${process.env.REACT_APP_API_URL}/visits/${visitId}`,\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n    const mainParkId = visitResponse.data.park.id;\r\n    const individualParksResponse = await axios.get(\r\n      `${process.env.REACT_APP_API_URL}/parks/${mainParkId}`,\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n    const individualParks = individualParksResponse.data.parks;\r\n    const attractionsPromises = individualParks.map((individualPark) =>\r\n      axios.get(\r\n        `${process.env.REACT_APP_API_URL}/parks/${individualPark.id}/attractions`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        }\r\n      )\r\n    );\r\n\r\n    const responses = await Promise.all(attractionsPromises);\r\n    return responses.flatMap((res) => res.data);\r\n  } catch (error) {\r\n    console.error(\"Error fetching attractions:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Deletes a visit from the database\r\nexport const deleteVisit = async (visitId, getAccessTokenSilently) => {\r\n  try {\r\n    const token = await getAccessTokenSilently();\r\n    await axios.delete(`${process.env.REACT_APP_API_URL}/visits/${visitId}`, {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error fetching parks: \", error);\r\n    throw error;\r\n  }\r\n};\r\n"],"mappings":"AAAA;;AAEA,OAAOA,KAAK,MAAM,OAAO;;AAIzB;AACA,OAAO,MAAMC,iBAAiB,GAAG,MAAAA,CAAOC,IAAI,EAAEC,sBAAsB,KAAK;EACvE,IAAI;IACF,MAAMC,MAAM,GAAGF,IAAI,CAACG,GAAG,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACrC,MAAMC,KAAK,GAAG,MAAMJ,sBAAsB,CAAC,CAAC;IAC5C,MAAMK,QAAQ,GAAG,MAAMR,KAAK,CAACS,GAAG,CAC9B,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,gBAAgBR,MAAM,EAAE,EACxD;MACES,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUP,KAAK;MAChC;IACF,CACF,CAAC;IACD,OAAOC,QAAQ,CAACO,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IAC/CC,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEhB,IAAI,CAACG,GAAG,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7C,MAAMU,KAAK;EACb;AACF,CAAC;;AAED;AACA,OAAO,MAAMG,eAAe,GAAG,MAAAA,CAAOC,OAAO,EAAEjB,sBAAsB,KAAK;EACxE;EACA,IAAI;IACF,MAAMI,KAAK,GAAG,MAAMJ,sBAAsB,CAAC,CAAC;;IAG5C;IACA,MAAMK,QAAQ,GAAG,MAAMR,KAAK,CAACS,GAAG,CAC9B,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,WAAWQ,OAAO,EAAE,EACpD;MACEP,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUP,KAAK;MAChC;IACF,CACF,CAAC;IAED,OAAOC,QAAQ,CAACO,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACtD,MAAMA,KAAK;EACb;AACF,CAAC;;AAED;AACA,OAAO,MAAMK,QAAQ,GAAG,MAAAA,CAAOC,KAAK,EAAEnB,sBAAsB,KAAK;EAC/D,IAAI;IACF,MAAMI,KAAK,GAAG,MAAMJ,sBAAsB,CAAC,CAAC;IAC5Cc,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEI,KAAK,CAAC;IAC7B,MAAMd,QAAQ,GAAG,MAAMR,KAAK,CAACuB,IAAI,CAAC,GAAGb,OAAO,CAACC,GAAG,CAACC,iBAAiB,SAAS,EAAEU,KAAK,EAAE;MAClFT,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUP,KAAK;MAChC;IACF,CAAC,CAAC;IACFU,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEV,QAAQ,CAAC;IACnC,OAAOA,QAAQ,CAACO,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;IAC5C,MAAMA,KAAK;EACb;AACF,CAAC;;AAED;AACA,OAAO,MAAMQ,UAAU,GAAG,MAAOrB,sBAAsB,IAAK;EAC1D,IAAI;IACF,MAAMI,KAAK,GAAG,MAAMJ,sBAAsB,CAAC,CAAC;IAC5C,MAAMK,QAAQ,GAAG,MAAMR,KAAK,CAACS,GAAG,CAAC,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,QAAQ,EAAE;MACzEC,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUP,KAAK;MAChC;IACF,CAAC,CAAC;IAEF,OAAOC,QAAQ,CAACO,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;IAC9C,MAAMA,KAAK;EACb;AACF,CAAC;;AAED;AACA,OAAO,MAAMS,mBAAmB,GAAG,MAAAA,CAAOL,OAAO,EAAEjB,sBAAsB,KAAK;EAC5E,IAAI;IACF,MAAMI,KAAK,GAAG,MAAMJ,sBAAsB,CAAC,CAAC;IAC5C,MAAMuB,aAAa,GAAG,MAAM1B,KAAK,CAACS,GAAG,CACnC,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,WAAWQ,OAAO,EAAE,EACpD;MACEP,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUP,KAAK;MAChC;IACF,CACF,CAAC;IACD,MAAMoB,UAAU,GAAGD,aAAa,CAACX,IAAI,CAACa,IAAI,CAACC,EAAE;IAC7C,MAAMC,uBAAuB,GAAG,MAAM9B,KAAK,CAACS,GAAG,CAC7C,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,UAAUe,UAAU,EAAE,EACtD;MACEd,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUP,KAAK;MAChC;IACF,CACF,CAAC;IACD,MAAMwB,eAAe,GAAGD,uBAAuB,CAACf,IAAI,CAACiB,KAAK;IAC1D,MAAMC,mBAAmB,GAAGF,eAAe,CAACG,GAAG,CAAEC,cAAc,IAC7DnC,KAAK,CAACS,GAAG,CACP,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,UAAUuB,cAAc,CAACN,EAAE,cAAc,EACzE;MACEhB,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUP,KAAK;MAChC;IACF,CACF,CACF,CAAC;IAED,MAAM6B,SAAS,GAAG,MAAMC,OAAO,CAACC,GAAG,CAACL,mBAAmB,CAAC;IACxD,OAAOG,SAAS,CAACG,OAAO,CAAEC,GAAG,IAAKA,GAAG,CAACzB,IAAI,CAAC;EAC7C,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;IACnD,MAAMA,KAAK;EACb;AACF,CAAC;;AAED;AACA,OAAO,MAAMyB,WAAW,GAAG,MAAAA,CAAOrB,OAAO,EAAEjB,sBAAsB,KAAK;EACpE,IAAI;IACF,MAAMI,KAAK,GAAG,MAAMJ,sBAAsB,CAAC,CAAC;IAC5C,MAAMH,KAAK,CAAC0C,MAAM,CAAC,GAAGhC,OAAO,CAACC,GAAG,CAACC,iBAAiB,WAAWQ,OAAO,EAAE,EAAE;MACvEP,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUP,KAAK;MAChC;IACF,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOS,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;IAC9C,MAAMA,KAAK;EACb;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}